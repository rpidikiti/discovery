(function(f){var l,y="",s=Math.PI,h=s/2,j="Touch" in window,c=(j)?{start:"touchstart",move:"touchmove",end:"touchend"}:{start:"mousedown",move:"mousemove",end:"mouseup"},t={backward:["bl","tl"],forward:["br","tr"],all:["tl","bl","tr","br"]},i=["single","double"],e={page:1,gradients:true,duration:600,acceleration:true,display:"double",when:null},a={folding:null,corners:"forward",cornerSize:100,gradients:true,duration:600,acceleration:true},x=6,r={0:{top:0,left:0,right:"auto",bottom:"auto"},1:{top:0,right:0,left:"auto",bottom:"auto"}},p=function(C,B,D,A){return{css:{position:"absolute",top:C,left:B,overflow:A||"hidden","z-index":D||"auto"}}},n=function(G,F,E,D,C){var A=1-C,B=A*A*A,H=C*C*C;return g(Math.round(B*G.x+3*C*A*A*F.x+3*C*C*A*E.x+H*D.x),Math.round(B*G.y+3*C*A*A*F.y+3*C*C*A*E.y+H*D.y))},z=function(A){return A/180*s},o=function(A){return A/s*180},g=function(A,B){return{x:A,y:B}},m=function(A,C,B){return(l&&B)?" translate3d("+A+"px,"+C+"px, 0px) ":" translate("+A+"px, "+C+"px) "},v=function(A){return" rotate("+A+"deg) "},d=function(B,A){return Object.prototype.hasOwnProperty.call(A,B)},q=function(){var B=["Moz","Webkit","Khtml","O","ms"],A=B.length,C="";while(A--){if((B[A]+"Transform") in document.body.style){C="-"+B[A].toLowerCase()+"-"}}return C},b=function(M,C,B,H,N){var Q,K=[];if(y=="-webkit-"){for(Q=0;Q<N;Q++){K.push("color-stop("+H[Q][0]+", "+H[Q][1]+")")}M.css({"background-image":"-webkit-gradient(linear, "+C.x+"% "+C.y+"%,  "+B.x+"% "+B.y+"%, "+K.join(",")+" )"})}else{C={x:C.x/100*M.width(),y:C.y/100*M.height()};B={x:B.x/100*M.width(),y:B.y/100*M.height()};var L=B.x-C.x,J=B.y-C.y,R=Math.atan2(J,L),D=R-Math.PI/2,P=Math.abs(M.width()*Math.sin(D))+Math.abs(M.height()*Math.cos(D)),A=Math.sqrt(J*J+L*L),F=g((B.x<C.x)?M.width():0,(B.y<C.y)?M.height():0),G=Math.tan(R),E=-1/G,I=(E*F.x-F.y-G*C.x+C.y)/(E-G),S={x:I,y:E*I-E*F.x+F.y},O=(Math.sqrt(Math.pow(S.x-C.x,2)+Math.pow(S.y-C.y,2)));for(Q=0;Q<N;Q++){K.push(" "+H[Q][1]+" "+((O+A*H[Q][0])*100/P)+"%")}M.css({"background-image":y+"linear-gradient("+(-R)+"rad,"+K.join(",")+")"})}},w={init:function(C){if(l===undefined){l="WebKitCSSMatrix" in window||"MozPerspective" in document.body.style;y=q()}var A,D=this.data(),B=this.children();if(D==null){this.data({});D={}}C=f.extend({width:this.width(),height:this.height()},e,C);D.opts=C;D.pageObjs={};D.pages={};D.pageWrap={};D.pagePlace={};D.pageMv=[];D.totalPages=C.pages||0;if(C.when){for(A in C.when){if(d(A,C.when)){this.bind(A,C.when[A])}}}this.css({position:"relative",width:C.width,height:C.height});this.turn("display",C.display);if(l&&!j&&C.acceleration){this.transform(m(0,0,true))}for(A=0;A<B.length;A++){this.turn("addPage",B[A],A+1)}this.turn("page",C.page);t=f.extend({},t,C.corners);f(this).bind(c.start,function(F){for(var E in D.pages){if(d(E,D.pages)&&u._eventStart.call(D.pages[E],F)===false){return false}}});f(document).bind(c.move,function(F){for(var E in D.pages){if(d(E,D.pages)){u._eventMove.call(D.pages[E],F)}}}).bind(c.end,function(F){for(var E in D.pages){if(d(E,D.pages)){u._eventEnd.call(D.pages[E],F)}}});D.done=true;return this},addPage:function(A,E){var B=false,D=this.data(),C=D.totalPages+1;if(E){if(E==C){E=C;B=true}else{if(E>C){throw new Error('It is impossible to add the page "'+E+'", the maximum value is: "'+C+'"')}}}else{E=C;B=true}if(E>=1&&E<=C){if(D.done){this.turn("stop")}if(E in D.pageObjs){w._movePages.call(this,E,1)}if(B){D.totalPages=C}D.pageObjs[E]=f(A).addClass("turn-page p"+E);w._addPage.call(this,E);if(D.done){this.turn("update")}w._removeFromDOM.call(this)}return this},_addPage:function(E){var D=this.data(),B=D.pageObjs[E];if(B){if(w._necessPage.call(this,E)){if(!D.pageWrap[E]){var A=(D.display=="double")?this.width()/2:this.width(),C=this.height();B.css({width:A,height:C});D.pagePlace[E]=E;D.pageWrap[E]=f("<div/>",{"class":"turn-page-wrapper",page:E,css:{position:"absolute",overflow:"hidden",width:A,height:C}}).css(r[(D.display=="double")?E%2:0]);this.append(D.pageWrap[E]);D.pageWrap[E].prepend(D.pageObjs[E])}if(!E||w._setPageLoc.call(this,E)==1){w._makeFlip.call(this,E)}}else{D.pagePlace[E]=0;if(D.pageObjs[E]){D.pageObjs[E].remove()}}}},hasPage:function(A){return A in this.data().pageObjs},_makeFlip:function(B){var A=this.data();if(!A.pages[B]&&A.pagePlace[B]==B){var D=A.display=="single",C=B%2;A.pages[B]=A.pageObjs[B].css({width:(D)?this.width():this.width()/2,height:this.height()}).flip({page:B,next:(D&&B===A.totalPages)?B-1:((C||D)?B+1:B-1),turn:this,duration:A.opts.duration,acceleration:A.opts.acceleration,corners:(D)?"all":((C)?"forward":"backward"),backGradient:A.opts.gradients,frontGradient:A.opts.gradients}).flip("disable",A.disabled).bind("pressed",w._pressed).bind("released",w._released).bind("start",w._start).bind("end",w._end).bind("flip",w._flip)}return A.pages[B]},_makeRange:function(){var C,B=this.data(),A=this.turn("range");for(C=A[0];C<=A[1];C++){w._addPage.call(this,C)}},range:function(E){var A,F,C,D=this.data();E=E||D.tpage||D.page;var B=w._view.call(this,E);if(E<1||E>D.totalPages){throw new Error('"'+E+'" is not a page for range')}B[1]=B[1]||B[0];if(B[0]>=1&&B[1]<=D.totalPages){A=Math.floor((x-2)/2);if(D.totalPages-B[1]>B[0]){F=Math.min(B[0]-1,A);C=2*A-F}else{C=Math.min(D.totalPages-B[1],A);F=2*A-C}}else{F=x-1;C=x-1}return[Math.max(1,B[0]-F),Math.min(D.totalPages,B[1]+C)]},_necessPage:function(B){if(B===0){return true}var A=this.turn("range");return B>=A[0]&&B<=A[1]},_removeFromDOM:function(){var B,A=this.data();for(B in A.pageWrap){if(d(B,A.pageWrap)&&!w._necessPage.call(this,B)){w._removePageFromDOM.call(this,B)}}},_removePageFromDOM:function(C){var B=this.data();if(B.pages[C]){var A=B.pages[C].data();if(A.f&&A.f.fwrapper){A.f.fwrapper.remove()}B.pages[C].remove();delete B.pages[C]}if(B.pageObjs[C]){B.pageObjs[C].remove()}if(B.pageWrap[C]){B.pageWrap[C].remove();delete B.pageWrap[C]}delete B.pagePlace[C]},removePage:function(B){var A=this.data();if(A.pageObjs[B]){this.turn("stop");w._removePageFromDOM.call(this,B);delete A.pageObjs[B];w._movePages.call(this,B,-1);A.totalPages=A.totalPages-1;w._makeRange.call(this);if(A.page>A.totalPages){this.turn("page",A.totalPages)}}return this},_movePages:function(F,E){var C,B=this.data(),D=B.display=="single",A=function(I){var G=I+E,H=G%2;if(B.pageObjs[I]){B.pageObjs[G]=B.pageObjs[I].removeClass("page"+I).addClass("page"+G)}if(B.pagePlace[I]&&B.pageWrap[I]){B.pagePlace[G]=G;B.pageWrap[G]=B.pageWrap[I].css(r[(D)?0:H]).attr("page",G);if(B.pages[I]){B.pages[G]=B.pages[I].flip("options",{page:G,next:(D||H)?G+1:G-1,corners:(D)?"all":((H)?"forward":"backward")})}if(E){delete B.pages[I];delete B.pagePlace[I];delete B.pageObjs[I];delete B.pageWrap[I];delete B.pageObjs[I]}}};if(E>0){for(C=B.totalPages;C>=F;C--){A(C)}}else{for(C=F;C<=B.totalPages;C++){A(C)}}},display:function(B){var A=this.data(),C=A.display;if(B){if(f.inArray(B,i)==-1){throw new Error('"'+B+'" is not a value for display')}if(B=="single"){if(!A.pageObjs[0]){this.turn("stop").css({overflow:"hidden"});A.pageObjs[0]=f("<div />",{"class":"turn-page p-temporal"}).css({width:this.width(),height:this.height()}).appendTo(this)}}else{if(A.pageObjs[0]){this.turn("stop").css({overflow:""});A.pageObjs[0].remove();delete A.pageObjs[0]}}A.display=B;return this}else{return C}},animating:function(){return this.data().pageMv.length>0},disable:function(B){var D,C=this.data(),A=this.turn("view");C.disabled=B===undefined||B===true;for(D in C.pages){if(d(D,C.pages)){C.pages[D].flip("disable",B?f.inArray(D,A):false)}}return this},size:function(C,A){if(C&&A){var E=this.data(),B=(E.display=="double")?C/2:C,D;this.css({width:C,height:A});if(E.pageObjs[0]){E.pageObjs[0].css({width:B,height:A})}for(D in E.pageWrap){if(!d(D,E.pageWrap)){continue}E.pageObjs[D].css({width:B,height:A});E.pageWrap[D].css({width:B,height:A});if(E.pages[D]){E.pages[D].css({width:B,height:A})}}this.turn("resize");return this}else{return{width:this.width(),height:this.height()}}},resize:function(){var B,A=this.data();if(A.pages[0]){A.pageWrap[0].css({left:-this.width()});A.pages[0].flip("resize",true)}for(B=1;B<=A.totalPages;B++){if(A.pages[B]){A.pages[B].flip("resize",true)}}},_removeMv:function(C){var A,B=this.data();for(A=0;A<B.pageMv.length;A++){if(B.pageMv[A]==C){B.pageMv.splice(A,1);return true}}return false},_addMv:function(B){var A=this.data();w._removeMv.call(this,B);A.pageMv.push(B)},_view:function(B){var A=this.data();B=B||A.page;if(A.display=="double"){return(B%2)?[B-1,B]:[B,B+1]}else{return[B]}},view:function(C){var B=this.data(),A=w._view.call(this,C);return(B.display=="double")?[(A[0]>0)?A[0]:0,(A[1]<=B.totalPages)?A[1]:0]:[(A[0]>0&&A[0]<=B.totalPages)?A[0]:0]},stop:function(C){var B,D,E=this.data(),A=E.pageMv;E.pageMv=[];if(E.tpage){E.page=E.tpage;delete E.tpage}for(B in A){if(!d(B,A)){continue}D=E.pages[A[B]].data().f.opts;u._moveFoldingPage.call(E.pages[A[B]],null);E.pages[A[B]].flip("hideFoldedPage");E.pagePlace[D.next]=D.next;if(D.force){D.next=(D.page%2===0)?D.page-1:D.page+1;delete D.force}}this.turn("update");return this},pages:function(A){var C=this.data();if(A){if(A<C.totalPages){for(var B=A+1;B<=C.totalPages;B++){this.turn("removePage",B)}if(this.turn("page")>A){this.turn("page",A)}}C.totalPages=A;return this}else{return C.totalPages}},_fitPage:function(C,A){var B=this.data(),D=this.turn("view",C);if(B.page!=C){this.trigger("turning",[C,D]);if(f.inArray(1,D)!=-1){this.trigger("first")}if(f.inArray(B.totalPages,D)!=-1){this.trigger("last")}}if(!B.pageObjs[C]){return}B.tpage=C;this.turn("stop",A);w._removeFromDOM.call(this);w._makeRange.call(this);this.trigger("turned",[C,D])},_turnPage:function(E){var F,B,D=this.data(),A=this.turn("view"),G=this.turn("view",E);if(D.page!=E){this.trigger("turning",[E,G]);if(f.inArray(1,G)!=-1){this.trigger("first")}if(f.inArray(D.totalPages,G)!=-1){this.trigger("last")}}if(!D.pageObjs[E]){return}D.tpage=E;this.turn("stop");w._makeRange.call(this);if(D.display=="single"){F=A[0];B=G[0]}else{if(A[1]&&E>A[1]){F=A[1];B=G[0]}else{if(A[0]&&E<A[0]){F=A[0];B=G[1]}}}if(D.pages[F]){var C=D.pages[F].data().f.opts;D.tpage=B;if(C.next!=B){C.next=B;D.pagePlace[B]=C.page;C.force=true}if(D.display=="single"){D.pages[F].flip("turnPage",(G[0]>A[0])?"br":"bl")}else{D.pages[F].flip("turnPage")}}},page:function(B){B=parseInt(B,10);var A=this.data();if(B>0&&B<=A.totalPages){if(!A.done||f.inArray(B,this.turn("view"))!=-1){w._fitPage.call(this,B)}else{w._turnPage.call(this,B)}return this}else{return A.page}},next:function(){var A=this.data();return this.turn("page",w._view.call(this,A.page).pop()+1)},previous:function(){var A=this.data();return this.turn("page",w._view.call(this,A.page).shift()-1)},_addMotionPage:function(){var C=f(this).data().f.opts,B=C.turn,A=B.data();C.pageMv=C.page;w._addMv.call(B,C.pageMv);A.pagePlace[C.next]=C.page;B.turn("update")},_start:function(F,C,B){var D=C.turn.data(),A=f.Event("start");F.stopPropagation();C.turn.trigger(A,[C,B]);if(A.isDefaultPrevented()){F.preventDefault();return}if(D.display=="single"){var E=B.charAt(1)=="l";if((C.page==1&&E)||(C.page==D.totalPages&&!E)){F.preventDefault()}else{if(E){C.next=(C.next<C.page)?C.next:C.page-1;C.force=true}else{C.next=(C.next>C.page)?C.next:C.page+1}}}w._addMotionPage.call(this)},_end:function(G,E){var D=f(this),F=D.data().f,C=F.opts,B=C.turn,A=B.data();G.stopPropagation();if(E||A.tpage){if(A.tpage==C.next||A.tpage==C.page){delete A.tpage;w._fitPage.call(B,A.tpage||C.next,true)}}else{w._removeMv.call(B,C.pageMv);B.turn("update")}},_pressed:function(){var E,C=f(this),D=C.data().f,B=D.opts.turn,A=B.data().pages;for(E in A){if(E!=D.opts.page){A[E].flip("disable",true)}}return D.time=new Date().getTime()},_released:function(D,A){var B=f(this),C=B.data().f;D.stopPropagation();if((new Date().getTime())-C.time<200||A.x<0||A.x>f(this).width()){D.preventDefault();C.opts.turn.data().tpage=C.opts.next;C.opts.turn.turn("update");f(B).flip("turnPage")}},_flip:function(){var A=f(this).data().f.opts;A.turn.trigger("turn",[A.next])},calculateZ:function(L){var D,G,J,B,K,F=this,C=this.data(),I=this.turn("view"),E=I[0]||I[1],A={pageZ:{},partZ:{},pageV:{}},H=function(N){var M=F.turn("view",N);if(M[0]){A.pageV[M[0]]=true}if(M[1]){A.pageV[M[1]]=true}};for(D=0;D<L.length;D++){G=L[D];J=C.pages[G].data().f.opts.next;B=C.pagePlace[G];H(G);H(J);K=(C.pagePlace[J]==J)?J:G;A.pageZ[K]=C.totalPages-Math.abs(E-K);A.partZ[B]=C.totalPages*2+Math.abs(E-K)}return A},update:function(){var E,D=this.data();if(D.pageMv.length&&D.pageMv[0]!==0){var C,F=this.turn("calculateZ",D.pageMv),B=this.turn("view",D.tpage);if(D.pagePlace[B[0]]==B[0]){C=B[0]}else{if(D.pagePlace[B[1]]==B[1]){C=B[1]}}for(E in D.pageWrap){if(!d(E,D.pageWrap)){continue}D.pageWrap[E].css({display:(F.pageV[E])?"":"none","z-index":F.pageZ[E]||0});if(D.pages[E]){D.pages[E].flip("z",F.partZ[E]||null);if(F.pageV[E]){D.pages[E].flip("resize")}if(D.tpage){D.pages[E].flip("disable",true)}}}}else{for(E in D.pageWrap){if(!d(E,D.pageWrap)){continue}var A=w._setPageLoc.call(this,E);if(D.pages[E]){D.pages[E].flip("disable",D.disabled||A!=1).flip("z",null)}}}},_setPageLoc:function(C){var B=this.data(),A=this.turn("view");if(C==A[0]||C==A[1]){B.pageWrap[C].css({"z-index":B.totalPages,display:""});return 1}else{if((B.display=="single"&&C==A[0]+1)||(B.display=="double"&&C==A[0]-2||C==A[1]+2)){B.pageWrap[C].css({"z-index":B.totalPages-1,display:""});return 2}else{B.pageWrap[C].css({"z-index":0,display:"none"});return 0}}}},u={init:function(A){if(A.gradients){A.frontGradient=true;A.backGradient=true}this.data({f:{}});this.flip("options",A);u._addPageWrapper.call(this);return this},setData:function(B){var A=this.data();A.f=f.extend(A.f,B);return this},options:function(A){var B=this.data().f;if(A){u.setData.call(this,{opts:f.extend({},B.opts||a,A)});return this}else{return B.opts}},z:function(B){var A=this.data().f;A.opts["z-index"]=B;A.fwrapper.css({"z-index":B||parseInt(A.parent.css("z-index"),10)||0});return this},_cAllowed:function(){return t[this.data().f.opts.corners]||this.data().f.opts.corners},_cornerActivated:function(F){if(F.originalEvent===undefined){return false}F=(j)?F.originalEvent.touches:[F];var D=this.data().f,H=D.parent.offset(),C=this.width(),B=this.height(),G={x:Math.max(0,F[0].pageX-H.left),y:Math.max(0,F[0].pageY-H.top)},E=D.opts.cornerSize,A=u._cAllowed.call(this);if(G.x<=0||G.y<=0||G.x>=C||G.y>=B){return false}if(G.y<E){G.corner="t"}else{if(G.y>=B-E){G.corner="b"}else{return false}}if(G.x<=E){G.corner+="l"}else{if(G.x>=C-E){G.corner+="r"}else{return false}}return(f.inArray(G.corner,A)==-1)?false:G},_c:function(B,A){A=A||0;return({tl:g(A,A),tr:g(this.width()-A,A),bl:g(A,this.height()-A),br:g(this.width()-A,this.height()-A)})[B]},_c2:function(A){return{tl:g(this.width()*2,0),tr:g(-this.width(),0),bl:g(this.width()*2,this.height()),br:g(-this.width(),this.height())}[A]},_foldingPage:function(B){var A=this.data().f.opts;if(A.folding){return A.folding}else{if(A.turn){var C=A.turn.data();if(C.display=="single"){return(C.pageObjs[A.next])?C.pageObjs[0]:null}else{return C.pageObjs[A.next]}}}},_backGradient:function(){var B=this.data().f,A=B.opts.turn,C=B.opts.backGradient&&(!A||A.data().display=="single"||(B.opts.page!=2&&B.opts.page!=A.data().totalPages-1));if(C&&!B.bshadow){B.bshadow=f("<div/>",p(0,0,1)).css({position:"",width:this.width(),height:this.height()}).appendTo(B.parent)}return C},resize:function(C){var E=this.data().f,D=this.width(),A=this.height(),B=Math.round(Math.sqrt(Math.pow(D,2)+Math.pow(A,2)));if(C){E.wrapper.css({width:B,height:B});E.fwrapper.css({width:B,height:B}).children(":first-child").css({width:D,height:A});E.fpage.css({width:A,height:D});if(E.opts.frontGradient){E.ashadow.css({width:A,height:D})}if(u._backGradient.call(this)){E.bshadow.css({width:D,height:A})}}if(E.parent.is(":visible")){E.fwrapper.css({top:E.parent.offset().top,left:E.parent.offset().left});if(E.opts.turn){E.fparent.css({top:-E.opts.turn.offset().top,left:-E.opts.turn.offset().left})}}this.flip("z",E.opts["z-index"])},_addPageWrapper:function(){var E,D=this.data().f,G=this.parent();if(!D.wrapper){var C=this.css("left"),F=this.css("top"),B=this.width(),H=this.height(),I=Math.round(Math.sqrt(Math.pow(B,2)+Math.pow(H,2)));D.parent=G;D.fparent=(D.opts.turn)?D.opts.turn.data().fparent:f("#turn-fwrappers");if(!D.fparent){var A=f("<div/>",{css:{"pointer-events":"none"}}).hide();A.data().flips=0;if(D.opts.turn){A.css(p(-D.opts.turn.offset().top,-D.opts.turn.offset().left,"auto","visible").css).appendTo(D.opts.turn);D.opts.turn.data().fparent=A}else{A.css(p(0,0,"auto","visible").css).attr("id","turn-fwrappers").appendTo(f("body"))}D.fparent=A}this.css({position:"absolute",top:0,left:0,bottom:"auto",right:"auto"});D.wrapper=f("<div/>",p(0,0,this.css("z-index"))).appendTo(G).prepend(this);D.fwrapper=f("<div/>",p(G.offset().top,G.offset().left)).hide().appendTo(D.fparent);D.fpage=f("<div/>",{css:{cursor:"default"}}).appendTo(f("<div/>",p(0,0,0,"visible")).appendTo(D.fwrapper));if(D.opts.frontGradient){D.ashadow=f("<div/>",p(0,0,1)).appendTo(D.fpage)}u.setData.call(this,D);u.resize.call(this,true)}},_fold:function(Q){var H=this,Y=0,F=0,V,K,E,C,B,N,G,L=g(0,0),U=g(0,0),A=g(0,0),P=this.width(),M=this.height(),X=u._foldingPage.call(this),T=Math.tan(F),Z=this.data().f,W=Z.opts.acceleration,S=Z.wrapper.height(),O=u._c.call(this,Q.corner),J=Q.corner.substr(0,1)=="t",D=Q.corner.substr(1,1)=="l",R=function(){var ak=g((O.x)?O.x-Q.x:Q.x,(O.y)?O.y-Q.y:Q.y),ah=(Math.atan2(ak.y,ak.x)),al;F=h-ah;Y=o(F);al=g((D)?P-ak.x/2:Q.x+ak.x/2,ak.y/2);var ac=F-Math.atan2(al.y,al.x),ab=Math.max(0,Math.sin(ac)*Math.sqrt(Math.pow(al.x,2)+Math.pow(al.y,2)));A=g(ab*Math.sin(F),ab*Math.cos(F));if(F>h){A.x=A.x+Math.abs(A.y*Math.tan(ah));A.y=0;if(Math.round(A.x*Math.tan(s-F))<M){Q.y=Math.sqrt(Math.pow(M,2)+2*al.x*ak.x);if(J){Q.y=M-Q.y}return R()}}if(F>h){var ai=s-F,aj=S-M/Math.sin(ai);L=g(Math.round(aj*Math.cos(ai)),Math.round(aj*Math.sin(ai)));if(D){L.x=-L.x}if(J){L.y=-L.y}}K=Math.round(A.y/Math.tan(F)+A.x);var ag=P-K,ae=ag*Math.cos(F*2),ad=ag*Math.sin(F*2);U=g(Math.round((D?ag-ae:K+ae)),Math.round((J)?ad:M-ad));N=ag*Math.sin(F);var aa=u._c2.call(H,Q.corner),af=Math.sqrt(Math.pow(aa.x-Q.x,2)+Math.pow(aa.y-Q.y,2));G=(af<P)?af/P:1;if(Z.opts.frontGradient){B=N>100?(N-100)/N:0;E=g(N*Math.sin(h-F)/M*100,N*Math.cos(h-F)/P*100);if(J){E.y=100-E.y}if(D){E.x=100-E.x}}if(u._backGradient.call(H)){C=g(N*Math.sin(F)/P*100,N*Math.cos(F)/M*100);if(!D){C.x=100-C.x}if(!J){C.y=100-C.y}}A.x=Math.round(A.x);A.y=Math.round(A.y);return true},I=function(ae,ad,ag,af){var ac=["0","auto"],ah=(P-S)*ag[0]/100,ab=(M-S)*ag[1]/100,ai={left:ac[ad[0]],top:ac[ad[1]],right:ac[ad[2]],bottom:ac[ad[3]]},aa=(af!=90&&af!=-90)?(D?-1:1):0;ag=ag[0]+"% "+ag[1]+"%";H.css(ai).transform(v(af)+m(ae.x+aa,ae.y,W),ag);Z.fpage.parent().css(ai);Z.wrapper.transform(m(-ae.x+ah-aa,-ae.y+ab,W)+v(-af),ag);Z.fwrapper.transform(m(-ae.x+L.x+ah,-ae.y+L.y+ab,W)+v(-af),ag);Z.fpage.parent().transform(v(af)+m(ae.x+U.x-L.x,ae.y+U.y-L.y,W),ag);if(Z.opts.frontGradient){b(Z.ashadow,g(D?100:0,J?100:0),g(E.x,E.y),[[B,"rgba(0,0,0,0)"],[((1-B)*0.8)+B,"rgba(0,0,0,"+(0.2*G)+")"],[1,"rgba(255,255,255,"+(0.2*G)+")"]],3,F)}if(u._backGradient.call(H)){b(Z.bshadow,g(D?0:100,J?0:100),g(C.x,C.y),[[0.8,"rgba(0,0,0,0)"],[1,"rgba(0,0,0,"+(0.3*G)+")"],[1,"rgba(0,0,0,0)"]],3)}};switch(Q.corner){case"tl":Q.x=Math.max(Q.x,1);R();I(A,[1,0,0,1],[100,0],Y);Z.fpage.transform(m(-M,-P,W)+v(90-Y*2),"100% 100%");X.transform(v(90)+m(0,-M,W),"0% 0%");break;case"tr":Q.x=Math.min(Q.x,P-1);R();I(g(-A.x,A.y),[0,0,0,1],[0,0],-Y);Z.fpage.transform(m(0,-P,W)+v(-90+Y*2),"0% 100%");X.transform(v(270)+m(-P,0,W),"0% 0%");break;case"bl":Q.x=Math.max(Q.x,1);R();I(g(A.x,-A.y),[1,1,0,0],[100,100],-Y);Z.fpage.transform(m(-M,0,W)+v(-90+Y*2),"100% 0%");X.transform(v(270)+m(-P,0,W),"0% 0%");break;case"br":Q.x=Math.min(Q.x,P-1);R();I(g(-A.x,-A.y),[0,1,1,0],[0,100],Y);Z.fpage.transform(v(90-Y*2),"0% 0%");X.transform(v(90)+m(0,-M,W),"0% 0%");break}Z.point=Q},_moveFoldingPage:function(A){var C=this.data().f,B=u._foldingPage.call(this);if(B){if(A){if(!C.fpage.children()[C.ashadow?"1":"0"]){u.setData.call(this,{backParent:B.parent()});C.fpage.prepend(B)}}else{if(C.backParent){C.backParent.prepend(B)}}}},_showFoldedPage:function(H,C){var D=u._foldingPage.call(this),B=this.data(),G=B.f;if(!G.point||G.point.corner!=H.corner){var F=f.Event("start");this.trigger(F,[G.opts,H.corner]);if(F.isDefaultPrevented()){return false}}if(D){if(C){var E=this,A=(G.point&&G.point.corner==H.corner)?G.point:u._c.call(this,H.corner,1);this.animatef({from:[A.x,A.y],to:[H.x,H.y],duration:500,frame:function(I){H.x=Math.round(I[0]);H.y=Math.round(I[1]);u._fold.call(E,H)}})}else{u._fold.call(this,H);if(B.effect&&!B.effect.turning){this.animatef(false)}}if(!G.fwrapper.is(":visible")){G.fparent.show().data().flips++;u._moveFoldingPage.call(this,true);G.fwrapper.show();if(G.bshadow){G.bshadow.show()}}return true}return false},hide:function(){var B=this.data().f,A=u._foldingPage.call(this);if((--B.fparent.data().flips)===0){B.fparent.hide()}this.css({left:0,top:0,right:"auto",bottom:"auto"}).transform("","0% 100%");B.wrapper.transform("","0% 100%");B.fwrapper.hide();if(B.bshadow){B.bshadow.hide()}A.transform("","0% 0%");return this},hideFoldedPage:function(A){var B=this.data().f;if(!B.point){return}var D=this,J=B.point,C=function(){B.point=null;D.flip("hide");D.trigger("end",[false])};if(A){var F=u._c.call(this,J.corner),E=(J.corner.substr(0,1)=="t"),I=(E)?Math.min(0,J.y-F.y)/2:Math.max(0,J.y-F.y)/2,H=g(J.x,J.y+I),G=g(F.x,F.y-I);this.animatef({from:0,to:1,frame:function(K){var L=n(J,H,G,F,K);J.x=L.x;J.y=L.y;u._fold.call(D,J)},complete:C,duration:800,hiding:true})}else{this.animatef(false);C()}},turnPage:function(C){var B=this,D=this.data().f;C={corner:(D.corner)?D.corner.corner:C||u._cAllowed.call(this)[0]};var E=D.point||u._c.call(this,C.corner,(D.opts.turn)?D.opts.turn.data().opts.elevation:0),A=u._c2.call(this,C.corner);this.trigger("flip").animatef({from:0,to:1,frame:function(F){var G=n(E,E,A,A,F);C.x=G.x;C.y=G.y;u._showFoldedPage.call(B,C)},complete:function(){B.trigger("end",[true])},duration:D.opts.duration,turning:true});D.corner=null},moving:function(){return"effect" in this.data()},isTurning:function(){return this.flip("moving")&&this.data().effect.turning},_eventStart:function(B){var A=this.data().f;if(!A.disabled&&!this.flip("isTurning")){A.corner=u._cornerActivated.call(this,B);if(A.corner&&u._foldingPage.call(this,A.corner)){u._moveFoldingPage.call(this,true);this.trigger("pressed",[A.point]);return false}else{A.corner=null}}},_eventMove:function(D){var C=this.data().f;if(!C.disabled){D=(j)?D.originalEvent.touches:[D];if(C.corner){var E=C.parent.offset();C.corner.x=D[0].pageX-E.left;C.corner.y=D[0].pageY-E.top;u._showFoldedPage.call(this,C.corner)}else{if(!this.data().effect&&this.is(":visible")){var B=u._cornerActivated.call(this,D[0]);if(B){var A=u._c.call(this,B.corner,C.opts.cornerSize/2);B.x=A.x;B.y=A.y;u._showFoldedPage.call(this,B,true)}else{u.hideFoldedPage.call(this,true)}}}}},_eventEnd:function(){var B=this.data().f;if(!B.disabled&&B.point){var A=f.Event("released");this.trigger(A,[B.point]);if(!A.isDefaultPrevented()){u.hideFoldedPage.call(this,true)}}B.corner=null},disable:function(A){u.setData.call(this,{disabled:A});return this}},k=function(C,A,B){if(!B[0]||typeof(B[0])=="object"){return A.init.apply(C,B)}else{if(A[B[0]]&&B[0].toString().substr(0,1)!="_"){return A[B[0]].apply(C,Array.prototype.slice.call(B,1))}else{throw B[0]+" is an invalid value"}}};f.extend(f.fn,{flip:function(B,A){return k(this,u,arguments)},turn:function(A){return k(this,w,arguments)},transform:function(B,A){var C={};if(A){C[y+"transform-origin"]=A}C[y+"transform"]=B;return this.css(C)},animatef:function(I){var D=this.data();if(D.effect){clearInterval(D.effect.handle)}if(I){if(!I.to.length){I.to=[I.to]}if(!I.from.length){I.from=[I.from]}if(!I.easing){I.easing=function(K,L,J,N,M){return N*Math.sqrt(1-(L=L/M-1)*L)+J}}var C,H=[],G=I.to.length,F=this,A=I.fps||30,B=-A,E=function(){var K,J=[];B=Math.min(I.duration,B+A);for(K=0;K<G;K++){J.push(I.easing(1,B,I.from[K],H[K],I.duration))}I.frame((G==1)?J[0]:J);if(B==I.duration){clearInterval(D.effect.handle);delete D.effect;F.data(D);if(I.complete){I.complete()}}};for(C=0;C<G;C++){H.push(I.to[C]-I.from[C])}D.effect=I;D.effect.handle=setInterval(E,A);this.data(D);E()}else{delete D.effect}}});f.isTouch=j})(jQuery);